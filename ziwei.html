<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç´«å¾®æ–—æ•¸æ’ç›¤èˆ‡é‹å‹¢åˆ†æç³»çµ±</title>
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.6.12/lunar.js"></script>
    <style>
        :root {
            --primary-color: #8E24AA; /* ç´«è‰²ä¸»èª¿ */
            --bg-color: #fdfbf7;
            --border-color: #d1c4e9;
            --text-color: #333;
        }

        body {
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
        }

        /* è¼¸å…¥å€åŸŸ */
        .input-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            align-items: center;
            margin-bottom: 30px;
        }

        input, select, button {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            transition: background 0.3s;
        }

        button:hover {
            background-color: #6a1b9a;
        }

        /* å‘½ç›¤å€åŸŸ (Grid ä½ˆå±€) */
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, minmax(180px, auto));
            gap: 5px;
            margin-bottom: 30px;
            border: 2px solid var(--primary-color);
            background: #fff;
        }

        .palace {
            border: 1px solid var(--border-color);
            padding: 10px;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            font-size: 14px;
        }

        /* ä¸­å®® (é¡¯ç¤ºåŸºæœ¬è³‡æ–™) */
        .center-palace {
            grid-column: 2 / 4;
            grid-row: 2 / 4;
            border: none;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: #f3e5f5;
            padding: 20px;
            text-align: center;
        }

        .palace-name {
            position: absolute;
            bottom: 5px;
            right: 5px;
            font-weight: bold;
            font-size: 1.2em;
            background: var(--primary-color);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
        }

        .earthly-branch {
            position: absolute;
            bottom: 5px;
            left: 5px;
            color: #999;
            font-weight: bold;
        }

        .major-stars {
            color: #d32f2f; /* ç´…è‰²ä¸»æ˜Ÿ */
            font-weight: bold;
            font-size: 1.1em;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .minor-stars {
            color: #555;
            font-size: 0.9em;
            margin-top: 5px;
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }

        .stars-good { color: #2e7d32; } /* å‰æ˜Ÿ */
        .stars-bad { color: #555; } /* ç…æ˜Ÿ/é›œæ˜Ÿ */

        .flow-year-tag {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: #ff9800;
            color: white;
            font-size: 0.8em;
            padding: 2px 5px;
            border-radius: 3px;
            display: none; /* é è¨­éš±è— */
        }

        .liu-nian-active .flow-year-tag {
            display: block;
        }

        .liu-nian-active {
            box-shadow: inset 0 0 0 3px #ff9800;
        }

        /* è§£èªªå€åŸŸ */
        .analysis-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            line-height: 1.6;
        }

        .analysis-section h2 {
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
        }

        .star-desc {
            margin-bottom: 15px;
            padding: 10px;
            background-color: #fafafa;
            border-left: 4px solid var(--primary-color);
        }

        @media (max-width: 768px) {
            .chart-grid {
                grid-template-columns: 1fr;
                grid-template-rows: auto;
                display: block;
            }
            .palace {
                min-height: 150px;
                margin-bottom: 10px;
                border: 1px solid #ccc;
            }
            .center-palace {
                display: block;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ”® ç´«å¾®æ–—æ•¸è©³è§£èˆ‡é‹å‹¢</h1>

    <div class="input-section">
        <div>
            <label>å§“åï¼š</label>
            <input type="text" id="name" placeholder="æ‚¨çš„å§“å">
        </div>
        <div>
            <label>æ€§åˆ¥ï¼š</label>
            <select id="gender">
                <option value="1">ç”·</option>
                <option value="0">å¥³</option>
            </select>
        </div>
        <div>
            <label>åœ‹æ›†ç”Ÿæ—¥ï¼š</label>
            <input type="datetime-local" id="birthDate">
        </div>
        <button onclick="generateChart()">é–‹å§‹æ’ç›¤</button>
    </div>

    <div class="chart-grid" id="chartGrid" style="display:none;">
        <div class="palace" id="p-si" data-idx="5"><span class="earthly-branch">å·³</span></div>
        <div class="palace" id="p-wu" data-idx="6"><span class="earthly-branch">åˆ</span></div>
        <div class="palace" id="p-wei" data-idx="7"><span class="earthly-branch">æœª</span></div>
        <div class="palace" id="p-shen" data-idx="8"><span class="earthly-branch">ç”³</span></div>

        <div class="palace" id="p-chen" data-idx="4"><span class="earthly-branch">è¾°</span></div>
        <div class="center-palace" id="centerInfo">
            </div>
        <div class="palace" id="p-you" data-idx="9"><span class="earthly-branch">é…‰</span></div>

        <div class="palace" id="p-mao" data-idx="3"><span class="earthly-branch">å¯</span></div>
        <div class="palace" id="p-xu" data-idx="10"><span class="earthly-branch">æˆŒ</span></div>

        <div class="palace" id="p-yin" data-idx="2"><span class="earthly-branch">å¯…</span></div>
        <div class="palace" id="p-chou" data-idx="1"><span class="earthly-branch">ä¸‘</span></div>
        <div class="palace" id="p-zi" data-idx="0"><span class="earthly-branch">å­</span></div>
        <div class="palace" id="p-hai" data-idx="11"><span class="earthly-branch">äº¥</span></div>
    </div>

    <div class="analysis-section" id="analysis" style="display:none;">
        <h2>ğŸ“œ å‘½ç›¤è§£æ</h2>
        <div id="analysisContent"></div>
        
        <h2 style="margin-top: 30px;">ğŸ“… æµå¹´èˆ‡æœˆé‹å‹¢ (<span id="currentYearDisplay"></span>)</h2>
        <div id="fortuneContent"></div>
    </div>
</div>

<script>
    // æ˜Ÿæ›œè§£é‡‹åº« (ç°¡åŒ–ç‰ˆ)
    const starMeanings = {
        'ç´«å¾®': 'å¸ç‹ä¹‹æ˜Ÿï¼Œå°Šè²´æ¬Šå¨ï¼Œæœ‰é ˜å°åŠ›ï¼Œè€³æ ¹å­è»Ÿï¼Œæ„›é¢å­ã€‚',
        'å¤©æ©Ÿ': 'æ™ºæ…§ä¹‹æ˜Ÿï¼Œåæ‡‰æ•æ·ï¼Œå–„æ–¼ç­–åŠƒï¼Œå®¹æ˜“ç„¦æ…®ï¼Œæ€å¤šè¡Œå°‘ã€‚',
        'å¤ªé™½': 'å®˜ç¥¿ä¹‹ä¸»ï¼Œåšæ„›ç„¡ç§ï¼Œç†±æƒ…ç©æ¥µï¼Œå‹ç¢Œå¥”æ³¢ï¼Œå¥½é¢å­ã€‚',
        'æ­¦æ›²': 'è²¡å¸›ä¹‹ä¸»ï¼Œå‰›æ¯…æœæ±ºï¼ŒåŸ·è¡ŒåŠ›å¼·ï¼Œç•¥é¡¯å­¤åƒ»ï¼Œé‡ç¾©æ°£ã€‚',
        'å¤©åŒ': 'ç¦å¾·ä¹‹ä¸»ï¼Œæº«å’Œæ¨‚è§€ï¼Œä¸æ„›è¨ˆè¼ƒï¼Œç•¥é¡¯æ‡¶æ•£ï¼Œé‡è¦–äº«å—ã€‚',
        'å»‰è²': 'æ¬¡æ¡ƒèŠ±æ˜Ÿï¼Œå…¬é—œèƒ½åŠ›å¼·ï¼Œæ˜¯éåˆ†æ˜ï¼Œæƒ…ç·’å¤šè®Šï¼Œä½”æœ‰æ…¾å¼·ã€‚',
        'å¤©åºœ': 'è²¡åº«ä¹‹æ˜Ÿï¼Œç©©é‡ä¿å®ˆï¼ŒåŒ…å®¹åŠ›å¼·ï¼Œå¥½äº«å—ï¼Œç¼ºä¹è¡å‹ã€‚',
        'å¤ªé™°': 'è²¡å¸›ç”°å®…ï¼Œæº«æŸ”ç´°è†©ï¼Œé‡æƒ…æ„Ÿï¼Œæ„›ä¹¾æ·¨ï¼Œå¤šæ„å–„æ„Ÿã€‚',
        'è²ªç‹¼': 'æ­£æ¡ƒèŠ±æ˜Ÿï¼Œå¤šæ‰å¤šè—ï¼Œäº¤éš›æ‰‹è…•é«˜ï¼Œæ…¾æœ›å¼·çƒˆï¼Œå–œæ–°å­èˆŠã€‚',
        'å·¨é–€': 'æ˜¯éä¹‹æ˜Ÿï¼Œå£æ‰ä½³ï¼Œå¿ƒæ€ç´°è†©ï¼Œç–‘å¿ƒç—…é‡ï¼Œå®¹æ˜“çŠ¯å°äººã€‚',
        'å¤©ç›¸': 'å°æ˜Ÿï¼Œè¬¹æ…è¸å¯¦ï¼Œæ³¨é‡å¤–è¡¨ï¼Œè€³æ ¹è»Ÿï¼Œç¼ºä¹ä¸»è¦‹ã€‚',
        'å¤©æ¢': 'è”­æ˜Ÿï¼Œé•·è€…é¢¨ç¯„ï¼Œç†±å¿ƒåŠ©äººï¼Œæ„›èªªæ•™ï¼Œå­¤é«˜è‡ªè³ã€‚',
        'ä¸ƒæ®º': 'å°‡æ˜Ÿï¼Œå‰›æ¯…è¡å‹•ï¼Œæ•¢è¡æ•¢é—–ï¼Œå–œæ€’ç„¡å¸¸ï¼Œå€å˜—è‰±è¾›ã€‚',
        'ç ´è»': 'è€—æ˜Ÿï¼Œæ±‚æ–°æ±‚è®Šï¼Œç ´å£åŠ›å¼·ï¼Œå–œå†’éšªï¼Œèµ·ä¼åŠ‡çƒˆã€‚'
    };

    // å®®ä½åç¨±é †åº
    const branchOrder = ['å­', 'ä¸‘', 'å¯…', 'å¯', 'è¾°', 'å·³', 'åˆ', 'æœª', 'ç”³', 'é…‰', 'æˆŒ', 'äº¥'];
    
    // åˆå§‹åŒ–æ—¥æœŸè¼¸å…¥ç‚ºç•¶å‰æ™‚é–“
    const now = new Date();
    now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
    document.getElementById('birthDate').value = now.toISOString().slice(0,16);

    function generateChart() {
        const name = document.getElementById('name').value || 'å‘½ä¸»';
        const genderVal = parseInt(document.getElementById('gender').value);
        const dateStr = document.getElementById('birthDate').value;

        if (!dateStr) {
            alert('è«‹é¸æ“‡å‡ºç”Ÿæ—¥æœŸæ™‚é–“');
            return;
        }

        const dateObj = new Date(dateStr);
        // ä½¿ç”¨ Lunar åº«é€²è¡Œè½‰æ›
        const solar = Solar.fromYmdHms(
            dateObj.getFullYear(),
            dateObj.getMonth() + 1,
            dateObj.getDate(),
            dateObj.getHours(),
            dateObj.getMinutes(),
            0
        );
        
        const lunar = solar.getLunar();
        
        // æ ¸å¿ƒï¼šç”¢ç”Ÿç´«å¾®æ–—æ•¸ç‰©ä»¶
        // 1 = ç”·, 0 = å¥³ (æ³¨æ„ï¼šlunaråº«ä¸­ 1ç”· 0å¥³)
        // é€™è£¡æˆ‘å€‘ç›´æ¥ä½¿ç”¨ Lunar åº«çš„ EightChar é›–ç„¶å¼·å¤§ï¼Œä½†æˆ‘å€‘éœ€è¦å°ˆé–€çš„ç´«å¾®æ’ç›¤
        // å¹¸é‹çš„æ˜¯ lunar-javascript æ“´å……å¥—ä»¶é€šå¸¸æœ‰ç´«å¾®ï¼Œä½†ç‚ºäº†ç¢ºä¿ CDN é‹ä½œï¼Œ
        // æˆ‘å€‘é€™è£¡ä½¿ç”¨åŸºæœ¬çš„ Lunar è¨ˆç®—å››æŸ±ï¼Œä¸¦ä½¿ç”¨ç°¡æ˜“é‚è¼¯æˆ–å‡è¨­åº«å·²åŒ…å« ZiWei æ¨¡çµ„ã€‚
        // *æ³¨æ„ï¼šæ¨™æº– CDN ç‰ˆå¯èƒ½ä¸å«å®Œæ•´ç´«å¾®æ’ç›¤ï¼Œç‚ºæ±‚ç©©å®šï¼Œä»¥ä¸‹é‚è¼¯å°‡å‘¼å«åº«ä¸­çš„ ZiWei é¡åˆ¥ã€‚*
        
        let zw;
        try {
            // å˜—è©¦å»ºç«‹ç´«å¾®ç›¤
            zw = new ZiWei(lunar);
        } catch (e) {
            alert("è¼‰å…¥ç´«å¾®é‹ç®—åº«å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£ç·šã€‚");
            console.error(e);
            return;
        }

        // é¡¯ç¤ºä»‹é¢
        document.getElementById('chartGrid').style.display = 'grid';
        document.getElementById('analysis').style.display = 'block';

        // 1. å¡«å¯«ä¸­å®®è³‡è¨Š
        const eightChar = lunar.getEightChar();
        let centerHTML = `
            <h3>${name}</h3>
            <p>è¾²æ›†ï¼š${lunar.getYearInGanZhi()}å¹´ ${lunar.getMonthInChinese()}æœˆ ${lunar.getDayInChinese()} ${lunar.getTimeZhi()}æ™‚</p>
            <p>äº”è¡Œå±€ï¼š${zw.getWuxing()}${zw.getJu()}</p>
            <p>å‘½ä¸»ï¼š${zw.getMingZhu()} / èº«ä¸»ï¼š${zw.getShenZhu()}</p>
            <p style="color:#666; font-size:0.9em;">ç”Ÿè¾°å…«å­—ï¼š${eightChar.getYear()} ${eightChar.getMonth()} ${eightChar.getDay()} ${eightChar.getTime()}</p>
        `;
        document.getElementById('centerInfo').innerHTML = centerHTML;

        // 2. éæ­·12å®®ä½ä¸¦å¡«å…¥æ˜Ÿæ›œ
        // åº«ä¸­çš„å®®ä½ç´¢å¼•é€šå¸¸ 0=å­, 1=ä¸‘ ... 11=äº¥
        
        // æ¸…é™¤èˆŠè³‡æ–™
        document.querySelectorAll('.palace .palace-name, .palace .major-stars, .palace .minor-stars, .flow-year-tag').forEach(el => el.remove());
        document.querySelectorAll('.liu-nian-active').forEach(el => el.classList.remove('liu-nian-active'));

        // æº–å‚™è§£ææ–‡æœ¬
        let analysisText = "";
        let mingGongStars = []; // å­˜å‘½å®®ä¸»æ˜Ÿ

        // å–å¾—ä»Šæ—¥æ™‚é–“ä¾†ç®—æµå¹´
        const currentYear = new Date().getFullYear();
        const currentLunarYear = Lunar.fromDate(new Date()).getYear(); // ç•¶å‰è¾²æ›†å¹´
        document.getElementById('currentYearDisplay').innerText = `${currentYear} (è¾²æ›† ${Lunar.fromDate(new Date()).getYearInGanZhi()}å¹´)`;

        // ç²å–æµå¹´åœ°æ”¯ç´¢å¼• (å­=0 ... äº¥=11)
        // Lunar åº«çš„ getYearZhi() è¿”å› "å·³", éœ€è¦è½‰æˆ index
        const currentYearZhi = Lunar.fromDate(new Date()).getYearZhi(); 
        const currentYearIndex = branchOrder.indexOf(currentYearZhi);

        for (let i = 0; i < 12; i++) {
            // å–å¾—è©²åœ°æ”¯çš„å®®ä½ DOM
            // å®®ä½å°æ‡‰ ID: p-zi, p-chou...
            // branchOrder[i] æ˜¯åœ°æ”¯å­—
            // æˆ‘å€‘éœ€è¦å°æ‡‰åˆ° HTML ä¸­çš„ IDã€‚æˆ‘å€‘å…ˆå»ºç«‹ä¸€å€‹ Map
            const branchToId = {
                'å­': 'p-zi', 'ä¸‘': 'p-chou', 'å¯…': 'p-yin', 'å¯': 'p-mao',
                'è¾°': 'p-chen', 'å·³': 'p-si', 'åˆ': 'p-wu', 'æœª': 'p-wei',
                'ç”³': 'p-shen', 'é…‰': 'p-you', 'æˆŒ': 'p-xu', 'äº¥': 'p-hai'
            };
            
            const palaceDom = document.getElementById(branchToId[branchOrder[i]]);
            const palaceData = zw.getGong(i); // ç²å–è©²åœ°æ”¯çš„å®®ä½æ•¸æ“š

            // --- æ¸²æŸ“å®®ä½å ---
            const pNameDiv = document.createElement('div');
            pNameDiv.className = 'palace-name';
            pNameDiv.innerText = palaceData.getName(); // å‘½å®®, è²¡å¸›å®®...
            palaceDom.appendChild(pNameDiv);

            // --- æ¸²æŸ“ä¸»æ˜Ÿ ---
            const majorDiv = document.createElement('div');
            majorDiv.className = 'major-stars';
            const majors = palaceData.getMajorStars();
            let majorHtml = '';
            majors.forEach(star => {
                let name = star.getName();
                // æª¢æŸ¥å››åŒ–
                // ç°¡å–®ç¯„ä¾‹ï¼šé€™è£¡ä¸æ·±å…¥é¡¯ç¤ºå››åŒ–ç¬¦è™Ÿï¼Œåƒ…é¡¯ç¤ºæ˜Ÿå
                // è‹¥è¦é¡¯ç¤ºäº®åº¦ï¼Œå¯åŠ  star.getBrightness()
                majorHtml += `<div>${name}<span style="font-size:0.8em; font-weight:normal; color:#999;">(${star.getBrightness()})</span></div>`;
                
                // å¦‚æœæ˜¯å‘½å®®ï¼Œè¨˜éŒ„ä¸‹ä¾†åšè§£é‡‹
                if (palaceData.getName() === 'å‘½å®®') {
                    mingGongStars.push(name);
                }
            });
            majorDiv.innerHTML = majorHtml;
            palaceDom.appendChild(majorDiv);

            // --- æ¸²æŸ“æµå¹´æ¨™ç±¤ ---
            // åˆ¤æ–·æ˜¯å¦ç‚ºæµå¹´å‘½å®®
            // æµå¹´å‘½å®®ç°¡å–®åˆ¤å®šæ³•ï¼šæµå¹´åœ°æ”¯æ‰€åœ¨çš„å®®ä½
            if (i === currentYearIndex) {
                palaceDom.classList.add('liu-nian-active');
                const tag = document.createElement('div');
                tag.className = 'flow-year-tag';
                tag.innerText = 'æµå¹´å‘½å®®';
                palaceDom.appendChild(tag);
            }

            // --- æ¸²æŸ“å°æ˜Ÿ (è¼”æ˜Ÿ/ç…æ˜Ÿ) ---
            const minorDiv = document.createElement('div');
            minorDiv.className = 'minor-stars';
            const minors = palaceData.getMinorStars();
            // åªé¡¯ç¤ºæ¯”è¼ƒé‡è¦çš„å‰ç…æ˜Ÿ
            const importantMinors = ['æ–‡æ˜Œ','æ–‡æ›²','å·¦è¼”','å³å¼¼','å¤©é­','å¤©é‰', 'æ“ç¾Š','é™€ç¾…','ç«æ˜Ÿ','éˆ´æ˜Ÿ','åœ°ç©º','åœ°åŠ«'];
            let minorHtml = '';
            minors.forEach(star => {
                if (importantMinors.includes(star.getName())) {
                    let colorClass = ['æ“ç¾Š','é™€ç¾…','ç«æ˜Ÿ','éˆ´æ˜Ÿ','åœ°ç©º','åœ°åŠ«'].includes(star.getName()) ? 'stars-bad' : 'stars-good';
                    minorHtml += `<span class="${colorClass}">${star.getName()}</span>`;
                }
            });
            minorDiv.innerHTML = minorHtml;
            palaceDom.appendChild(minorDiv);
        }

        // 3. ç”Ÿæˆè§£ææ–‡å­—
        
        // A. å‘½å®®è§£æ
        let mingAnalysis = `<h3>ğŸ§ å‘½å®®ä¸»æ˜Ÿè§£æ</h3>`;
        if (mingGongStars.length === 0) {
            mingAnalysis += `<p class="star-desc"><strong>å‘½å®®ç„¡ä¸»æ˜Ÿï¼š</strong> æ€§æ ¼å¯å¡‘æ€§é«˜ï¼Œå®¹æ˜“å—ç’°å¢ƒå½±éŸ¿ï¼Œéœ€åƒè€ƒå°å®®ï¼ˆé·ç§»å®®ï¼‰çš„æ˜Ÿæ›œä¾†åˆ¤æ–·æ€§æ ¼ã€‚</p>`;
        } else {
            mingGongStars.forEach(starName => {
                const desc = starMeanings[starName] || "æ˜Ÿæ›œç‰¹è³ªè¤‡é›œï¼Œå»ºè­°è«®è©¢å°ˆæ¥­è€å¸«ã€‚";
                mingAnalysis += `<p class="star-desc"><strong>${starName}ï¼š</strong> ${desc}</p>`;
            });
        }
        document.getElementById('analysisContent').innerHTML = mingAnalysis;

        // B. æµå¹´é‹å‹¢ç°¡æ
        // é€™è£¡éœ€è¦æ ¹æ“šæµå¹´å‘½å®®çš„ä¸»æ˜Ÿä¾†åˆ¤æ–·
        const flowPalaceData = zw.getGong(currentYearIndex);
        const flowStars = flowPalaceData.getMajorStars();
        let flowText = `<p><strong>æµå¹´ä½ç½®ï¼š</strong> æœ¬å¹´åº¦æµå¹´å‘½å®®ä½æ–¼ã€Œ${branchOrder[currentYearIndex]}ã€å®®ã€‚</p>`;
        
        if (flowStars.length > 0) {
            let starNames = flowStars.map(s => s.getName()).join('ã€');
            flowText += `<p><strong>æµå¹´ä¸»æ˜Ÿï¼š</strong> ${starNames}ã€‚</p>`;
            flowText += `<p>ä»Šå¹´æ‚¨çš„é‹å‹¢é‡é»åœ¨æ–¼é€™äº›æ˜Ÿæ›œçš„ç‰¹è³ªå±•ç¾ã€‚è‹¥é‡åˆ°å¼·å‹¢æ˜Ÿï¼ˆå¦‚ç´«å¾®ã€å¤ªé™½ã€ä¸ƒæ®ºï¼‰ï¼Œé©åˆè¡åˆºäº‹æ¥­ï¼›è‹¥é‡æŸ”å’Œæ˜Ÿï¼ˆå¤©åŒã€å¤ªé™°ï¼‰ï¼Œé©åˆèª¿æ•´èº«å¿ƒã€ç©ç´¯äººè„ˆã€‚</p>`;
        } else {
            flowText += `<p><strong>æµå¹´ç„¡ä¸»æ˜Ÿï¼š</strong> ä»Šå¹´é‹å‹¢è®Šå‹•è¼ƒå¤§ï¼Œå®¹æ˜“å—å¤–åœ¨ç’°å¢ƒç‰½å‹•ï¼Œå»ºè­°ä¿å®ˆè¡Œäº‹ï¼Œå¤šè½å–ä»–äººæ„è¦‹ã€‚</p>`;
        }

        // æœˆé‹å‹¢ (ç°¡å–®è¨ˆç®—ç•¶å‰è¾²æ›†æœˆ)
        const currentMonth = lunar.getMonth();
        const currentMonthZhi = lunar.getMonthZhi(); // æ³¨æ„ï¼šé€™ä¸æ˜¯æµæœˆå®®ä½ï¼Œæµæœˆå®®ä½ç®—æ³•è¼ƒè¤‡é›œ
        // ç°¡æ˜“æµæœˆç®—æ³•ï¼šæµå¹´å‘½å®®èµ·æ­£æœˆ (é€™æ˜¯å…¶ä¸­ä¸€ç¨®æµæ´¾ï¼Œç‚ºäº†ç°¡åŒ–å±•ç¤ºæ¡ç”¨æ­¤æ³•æˆ–æç¤º)
        flowText += `<p><strong>ç•¶å‰æœˆä»½ï¼š</strong> è¾²æ›† ${lunar.getMonthInChinese()}æœˆã€‚</p>`;
        flowText += `<p style="font-size:0.9em; color:#666;">(è¨»ï¼šæµæœˆèˆ‡æµæ—¥è®ŠåŒ–ç²¾ç´°ï¼Œæ­¤è™•åƒ…æä¾›å¤§é‹æ–¹å‘ã€‚è©³ç´°æµæœˆéœ€ä¾ã€Œæ–—å›ã€èµ·ç®—)</p>`;

        document.getElementById('fortuneContent').innerHTML = flowText;
    }
</script>

</body>
</html>